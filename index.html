<!DOCTYPE html>
<html lang="ka">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Molscreen Pro</title>
    <style>
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; background: #000; cursor: none; }
        video { width: 100vw; height: 100vh; object-fit: cover; position: absolute; top: 0; left: 0; }
    </style>
</head>
<body>

<video id="player" autoplay muted playsinline></video>

<script>
    const playlist = [
        "https://www.dropbox.com/scl/fi/cgq2z7linqasvqezbm8ab/gochits.mp4?rlkey=274k4goiciju5otq7qizctanh&st=u2qj0hb9&raw=1",
        "https://www.dropbox.com/scl/fi/b5h43u2gtqa9tb7mcvxg0/goge.mp4?rlkey=1zcjj2h6t7wvp3xz4kplnednr&st=ad2g4vla&raw=1",
        "https://www.dropbox.com/scl/fi/e2taoclzs6h5d09bi6vh2/kfc.mp4?rlkey=ti378vkzzqshy98i4xg7e2z13&st=xo7uj41y&raw=1",
        "https://www.dropbox.com/scl/fi/fjlmicsw8e3wocrnwvobh/mallscreen_promo.mp4?rlkey=7toe1bduhyx9ly42h7qbj1u23&st=fo8by9by&raw=1",
        "https://www.dropbox.com/scl/fi/k4pkuv2rqtzviddjnv5an/marge.mp4?rlkey=6a0d94c1shuqp9usqwggjxeim&st=by7r8osn&raw=1",
        "https://www.dropbox.com/scl/fi/7whs9yqdaiq0o4mvlarhb/satamashoebi.mp4?rlkey=dgqeekoyj8etov8on6k8vrxoy&st=i3z5izrb&raw=1",
        "https://www.dropbox.com/scl/fi/mbmod4obbvmuyiofc77ml/velosipedebi.mp4?rlkey=8gnk7u7w1hrzsvrd7z42n0dzk&st=4xjy6085&raw=1"
    ];

    const player = document.getElementById('player');
    let currentIndex = 0;

    // ფუნქცია, რომელიც ამზადებს შემდეგ ვიდეოს მეხსიერებაში
    function preloadNext() {
        const nextIdx = (currentIndex + 1) % playlist.length;
        const link = document.createElement('link');
        link.rel = 'preload';
        link.as = 'video';
        link.href = playlist[nextIdx];
        document.head.appendChild(link);
    }

    function playNext() {
        player.src = playlist[currentIndex];
        player.play().then(() => {
            preloadNext(); // სანამ ეს უკრავს, შემდეგს "ვქაჩავთ"
        }).catch(err => {
            console.log("Retry...", err);
            setTimeout(playNext, 1000);
        });
        
        currentIndex = (currentIndex + 1) % playlist.length;
    }

    player.onended = playNext;

    // პირველი გაშვება
    playNext();

    // Service Worker-ის რეგისტრაცია ოფლაინ მუშაობისთვის
    if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('./sw.js');
    }
</script>
</body>
</html>
